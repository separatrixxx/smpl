# Это проект .smpl - таск-менеджер, интегрированный с Телеграммом.

### Структура проекта:

`public` - публичные ассеты:

`icons` - иконки приложения
`images` - обшие картинки
`scripts` - общие скрипты

`src` - весь фронтенд проекта:

`app` - главная страница и лайаут, директории со страницами. Внутри директории страницы (например, `workspace`), может быть директория `ui` или любая другая относящаяся непосредственно к этой странице. Также здесь находится директория `api` с API роутами Next.js
`entities` - функционал для взаиможействия отдельной сущности с бэком (моки, интерфейсы, функции апи)
`features` - кастомные хуки, общие для всего проекта
`shared` - все общие утилиты, компоненты, локализация и прочее
`widgets` - виджеты, состоящие из нескольких атомарных компонентов. У виджета может быть свой `ui`, хуки и тд

`prisma` - схема базы данных и миграции

### Технический стек:

Приложение написона на Next.js с использованием App Router. Все стили пишутся на Sass, после каждого взаимодействия со стилями необходимо использовать `npm run stylelint`. Взаимодействие с бэком реализуется при помощи SWR + axios. В качестве хранилища данных выступает Zustand. База данных - PostgreSQL через Prisma ORM.

### Основная информация:

В основе менеджера лежат воркспейсы. Глобально они делятся на личный "My workspace" и все остальные - командные. Личный воркспейс создаётся автоматически при создании пользователя. Личный воркспейс отличается от командных тем, что прямо в нём можно создавать задачи. У каждого воркспейса имеются проекты - сборники задач. Каждый проект привязан к конкретному воркспейсу. Внутри проекта лежит самая маленькая единица - задача, у которой есть статус. Статус можно менять.

### База данных (Prisma):

Модели:
- `User` - пользователь (id, telegram_id, first_name, last_name, username, photo_url). `telegram_id` - уникальный идентификатор из Telegram (BigInt)
- `Workspace` - воркспейс (id, title, description, is_my_workspace, owner_id)
- `UserWorkspace` - связь пользователя и воркспейса (для teammates)
- `Project` - проект (id, workspace_id, title, description, is_starred)
- `Task` - задача (id, workspace_id, project_id, title, is_starred, priority, date, status)

Статусы задач (`TaskStatus`): `todo`, `progress`, `review`, `done`

### API роуты:

- `/api/user` - GET (список), POST (создание, требует telegram_id)
- `/api/user/[id]` - GET (получение по внутреннему id)
- `/api/user/telegram/[telegramId]` - GET (получение по Telegram ID)
- `/api/workspace` - GET (список, с `?userId` для фильтрации), POST (создание)
- `/api/workspace/my` - GET (личный воркспейс пользователя, с `?userId`)
- `/api/workspace/[id]` - GET, PUT, DELETE
- `/api/project` - GET (список, с `?workspace` для фильтрации), POST (создание)
- `/api/project/[id]` - GET, PUT, DELETE
- `/api/task` - GET (список, с `?workspace`, `?project`, `?userId`), POST (создание)
- `/api/task/[id]` - GET, PUT, DELETE
- `/api/teammate` - POST (добавление), DELETE (удаление)
- `/api/teammate/[workspaceId]` - GET (список тиммейтов воркспейса)

### Стиль кода:

- Два отступа между импортами и кодом
- Между импортами отступы не нужны
- Моки хранятся в `entities/*/mocks/`, но в продакшене используются реальные API
- В импортах сначала идут пропсы, потом стили, в самом конце `classnames`
- Пробелы внутри фигурных скобок: `{ value }` вместо `{value}`
- Поля интерфейсов отделяем запятыми
